/*<FH+>************************************************************************/
/*                                                                            */
/* 版权所有: Copyright (C) 烽鸟出行. 2019. All rights reserved.               */
/*                                                                            */
/* 文件名称: drv_w25qxx.h                                                     */
/* 内容摘要: W25Qxx芯片（SPI接口FLASH）驱动实现的头文件                      */
/* 其它说明: 无                                                               */
/* 当前版本: v 1.0.0                                                          */
/* 作    者: Leonard                                                          */
/* 完成日期: 2020-12-09                                                       */
/* 修改记录:                                                                  */
/*     修改日期          版本号     修改人          修改内容                 */
/* -------------------------------------------------------------------------- */
/*     2020-12-09        v 1.0.0     Leonard         创建文件                 */
/*<FH->************************************************************************/
#ifndef DRV_W25QXX_H
#define DRV_W25QXX_H

/******************************************************************************/
/*               #include(依次为标准库头文件、非标准库头文件)                */
/******************************************************************************/
#include "bsp_spi.h"

/******************************************************************************/
/*                              其他条件编译选项                              */
/******************************************************************************/
#ifdef __cplusplus
extern "C" {
#endif

/******************************************************************************/
/*                                  常量定义                                  */
/******************************************************************************/


/******************************************************************************/
/*                                 全局宏定义                                 */
/******************************************************************************/
#define W25QXX_FLASH_ERASE_CHIP       0x01        /* 设备操作码之按页擦除    */
#define W25QXX_FLASH_ERASE_SECTOR     0x02        /* 设备操作码之按节擦除    */

/******************************************************************************/
/*                              全局数据类型定义                              */
/******************************************************************************/
#pragma pack(1)

/*<STRUCT+>********************************************************************/
/* 结构: _W25QXX_PARA                                                         */
/* 注释: W25Qxx配置参数结构体                                                 */
/*<STRUCT->********************************************************************/
struct _w25qxx_para
{
    GPIO_TypeDef             *cs_port;               /* 片选端              */
    unsigned int              cs_pin;                /* 片选脚              */
    unsigned int              page_size;             /* 具体芯片page大小    */
    unsigned int              sector_size;           /* 具体芯片sector大小  */ 
    unsigned int              flash_size;            /* 具体芯片flash总大小 */
};
typedef struct _w25qxx_para *w25qxx_para_t;

/*<STRUCT+>********************************************************************/
/* 结构: W25QXX_DEVICE                                                        */
/* 注释: W25Qxx设备结构体                                                     */
/*<STRUCT->********************************************************************/
struct w25qxx_device
{   
    struct device             dev;                   /* W25Qxx设备          */
    spi_bus_dev_t             spix;                  /* SPIx总线设备        */
    struct _w25qxx_para       para;                  /* W25Qxx配置参数      */
#ifdef  BSP_USE_RT_THREAD
    rt_mutex_t                lock;                  /* W25Qxx设备锁        */
#endif
};
typedef struct w25qxx_device *w25qxx_device_t;

#pragma pack()

/******************************************************************************/
/*                                全局变量声明                                */
/******************************************************************************/


/******************************************************************************/
/*                                 全局函数原型                               */
/******************************************************************************/
int bsp_w25qxx_init(const char *name, const char *bus_name);


#ifdef __cplusplus
    }
#endif

#endif


