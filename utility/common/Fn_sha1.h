/*<FH+>************************************************************************/
/*                                                                            */
/* 版权所有: Copyright (C) 烽鸟出行. 2019. All rights reserved.               */
/*                                                                            */
/* 文件名称: Fn_sha1.h                                                        */
/* 内容摘要: SHA-1校验实现头文件                                             */
/* 其它说明: 无                                                               */
/* 当前版本: v 1.0.0                                                          */
/* 作    者: Leonard                                                          */
/* 完成日期: 2020-10-30                                                       */
/* 修改记录:                                                                  */
/*     修改日期          版本号     修改人          修改内容                 */
/* -------------------------------------------------------------------------- */
/*     2020-10-30        v 1.0.0     Leonard         创建文件                 */
/*<FH->************************************************************************/
#ifndef FN_SHA1_H
#define FN_SHA1_H

/******************************************************************************/
/*               #include(依次为标准库头文件、非标准库头文件)                */
/******************************************************************************/


/******************************************************************************/
/*                              其他条件编译选项                              */
/******************************************************************************/
#ifdef __cplusplus
extern "C" {
#endif

/******************************************************************************/
/*                                  常量定义                                  */
/******************************************************************************/


/******************************************************************************/
/*                                 全局宏定义                                 */
/******************************************************************************/
#define SHA1_LEN                    (20)             /* SHA1计算结果输出长度 */

/******************************************************************************/
/*                              全局数据类型定义                              */
/******************************************************************************/
struct _Sha1Digest
{
    unsigned int digest[5];
};
typedef struct _Sha1Digest Sha1Digest;

/*<STRUCT+>********************************************************************/
/* 结构: _SHA1_CTX                                                            */
/* 注释: SHA1数据结构体                                                       */
/*<STRUCT->********************************************************************/
struct _sha1_ctx
{
    unsigned char       block[64];
    unsigned int        h[5];
    unsigned long long  bytes;
    unsigned int        cur;
};
typedef struct _sha1_ctx SHA1_CTX;

/******************************************************************************/
/*                                全局变量声明                                */
/******************************************************************************/


/******************************************************************************/
/*                                 全局函数原型                               */
/******************************************************************************/
int SHA1_Init(SHA1_CTX *sha1);
int SHA1_Update(SHA1_CTX *sha1, unsigned char *input, unsigned int inlen);
int SHA1_Final(SHA1_CTX *sha1, unsigned char out[SHA1_LEN]);
int SHA1_Test(unsigned char *input, unsigned int inlen, unsigned char output[SHA1_LEN]);


#ifdef __cplusplus
}
#endif

#endif


