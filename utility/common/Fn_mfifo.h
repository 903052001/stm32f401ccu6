/*<FH+>************************************************************************/
/*                                                                            */
/* 版权所有: Copyright (C) 烽鸟出行. 2019. All rights reserved.               */
/*                                                                            */
/* 文件名称: Fn_mfifo.h                                                       */
/* 内容摘要: FIFO循环队列实现头文件                                          */
/* 其它说明: 无                                                               */
/* 当前版本: v 1.0.0                                                          */
/* 作    者: Leonard                                                          */
/* 完成日期: 2020-11-19                                                       */
/* 修改记录:                                                                  */
/*     修改日期          版本号     修改人          修改内容                 */
/* -------------------------------------------------------------------------- */
/*     2020-11-19        v 1.0.0     Leonard         创建文件                 */
/*<FH->************************************************************************/
#ifndef FN_MFIFO_H
#define FN_MFIFO_H

/******************************************************************************/
/*               #include(依次为标准库头文件、非标准库头文件)                */
/******************************************************************************/


/******************************************************************************/
/*                              其他条件编译选项                              */
/******************************************************************************/
#ifdef __cplusplus
extern "C" {
#endif

/******************************************************************************/
/*                                  常量定义                                  */
/******************************************************************************/


/******************************************************************************/
/*                                 全局宏定义                                 */
/******************************************************************************/
#define  __max(a, b)          (((a) > (b)) ? (a) : (b))
#define  __min(a, b)          (((a) < (b)) ? (a) : (b))

#define  RING_D_VAL(a, b, c)  ((a >= b) ? (a - b) : (c - b + a)) /* 环回差值 */
#define  ABS_D_VAL(a, b)      ((a >= b) ? (a - b) : (b - a))     /* 绝对差值 */

/******************************************************************************/
/*                              全局数据类型定义                              */
/******************************************************************************/
#pragma pack(1)

/*<STRUCT+>********************************************************************/
/* 结构: _MFIFO                                                               */
/* 注释: FIFO结构定义                                                         */
/*<STRUCT->********************************************************************/
struct _mfifo
{
    unsigned char *buffer;                      /* 保存数据的缓冲区         */
      signed int   in;                          /* 写入数据的索引           */
      signed int   out;                         /* 读出数据的索引           */
    unsigned int   size : 31;                   /* 缓冲区的大小             */
    unsigned int   full : 1;                    /* 写入溢出标记             */
};
typedef struct _mfifo *mfifo_t;

#pragma pack()

/******************************************************************************/
/*                                全局变量声明                                */
/******************************************************************************/


/******************************************************************************/
/*                                 全局函数原型                               */
/******************************************************************************/
int mfifo_test(void);
int mfifo_init(struct _mfifo *fifo, unsigned char *buf, int size);
int mfifo_put(struct _mfifo *fifo, unsigned char *buf, int len);
int mfifo_get(struct _mfifo *fifo, unsigned char *buf, int len);
int mfifo_have(struct _mfifo *fifo);


#ifdef __cplusplus
}
#endif

#endif

